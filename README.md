# Populus â€” A Populous: The Beginning World Simulator

> A faithful recreation of **Populous: The Beginning** (Bullfrog Productions, 1998) as a living world simulator built in **Godot 4.6**, using a **custom lightweight ECS** architecture for maximum modularity and extensibility.

---

## Vision

Recreate the complete game experience of Populous: The Beginning â€” the spherical planetoid, real-time terrain manipulation, autonomous tribal settlements, spell system, and unit AI â€” **plus extend it** with autonomous fauna/flora ecosystems, weather, day/night cycles, and biome-driven world simulation. All visuals are procedural placeholders (colored geometry, no sprites).

**World-First Philosophy**: The entire planet must live, breathe, and simulate autonomously before any player interaction is added. Tribes settle, animals hunt, trees grow, weather changes â€” all without a human player. The player is the *last* thing we build.

The architecture is designed so that **any new behavior or system can be added by dropping in one Component file and one System file** â€” no rewiring, no deep inheritance chains.

---

## What is Populous: The Beginning?

### The Original Game (1998)

Populous: The Beginning was developed by **Bullfrog Productions** and published by **Electronic Arts**. It was the third entry in the Populous series and represented a radical departure from its predecessors:

- **Shifted from God Game to RTS**: The player controls a **Shaman** (not a god) who directly leads her tribe, with the goal of ascending to godhood by conquering 25 planets across a solar system.
- **First 3D entry**: Used a custom-built 3D engine with a **spherical planetoid** that could be rotated 360Â°.
- **"Smart" Followers**: Villagers (Braves) autonomously build huts, harvest wood, and populate â€” the player only needs to direct military actions and spell casting.
- **Terrain Manipulation**: The Shaman can raise/lower terrain, create land bridges, trigger volcanic eruptions, earthquakes, and more.
- **No Formal Resources**: Only **wood** (for building) and **mana** (generated by housed followers, for spells). No gold, no food â€” just population management.

### Core Technical Innovation

The planet in Populous: The Beginning is **not a true sphere**. It uses a **flat torus topology** (a 2D grid that wraps on both X and Y axes, like Asteroids) which is then **locally projected onto a sphere** for rendering. This gives the illusion of a round planet while keeping all game logic on a simple, uniform square grid. When zoomed out to the globe view, the terrain is warped onto a smooth sphere; when zoomed in, distortion is negligible.

---

## Game Systems Breakdown

### 1. The Planet & Terrain

| Aspect | Original | Our Approach |
|---|---|---|
| **Topology** | Flat torus projected to sphere | Flat torus grid â†’ sphere projection via vertex shader |
| **Grid** | Square tiles, uniform size | 128Ã—128 or 256Ã—256 tile grid, wrapping on both axes |
| **Height** | Per-vertex heightmap, discrete levels | Per-vertex heightmap with smooth interpolation |
| **Manipulation** | Raise, Lower, Flatten, Landbridge, Erode, Volcano, Earthquake | Same â€” each is an ECS System operating on HeightmapComponent |
| **Textures** | Altitude-based blending with masks | Procedural shader: altitude + moisture + temperature â†’ biome texture |
| **Water** | Sea level plane | Animated water plane at configurable sea level |

### 2. Units / Followers

| Unit | Role | Combat | Special |
|---|---|---|---|
| **Brave** | Worker. Builds huts, towers, training buildings. Harvests wood. | Weak melee | Auto-builds, auto-populates huts |
| **Warrior** | Frontline melee fighter. Trained at Warrior Training Hut. | Strong melee | Highest HP of all non-Shaman units |
| **Firewarrior** | Ranged attacker. Trained at Temple of Fire. | Ranged (fireball) | Low HP, high DPS at range |
| **Preacher** | Converter. Trained at Temple. | Conversion aura | Converts enemy units; blocks enemy preachers |
| **Spy** | Infiltrator. Trained at Spy Training Hut. | Disguise | Can sabotage buildings, scout enemy bases |
| **Shaman** | Leader. Casts spells. One per tribe. | Spells | Reincarnates at Circle of Reincarnation if killed |
| **Wildmen** | Neutral. Cluster near trees/water. | None | Can be converted by any Shaman |

### 3. Buildings

| Building | Function | Requirements |
|---|---|---|
| **Hut** (Small/Medium/Large) | Houses Braves. Produces new Braves over time. Housed Braves generate **mana**. | Wood (trees) + flat terrain |
| **Guard Tower** | Garrison point. Extends range of any unit inside (Shaman spells, Firewarrior shots, Preacher aura, Brave sight). | Wood + flat terrain |
| **Warrior Training Hut** | Converts Braves â†’ Warriors | Wood + flat terrain |
| **Temple of Fire** | Converts Braves â†’ Firewarriors | Wood + flat terrain |
| **Temple** | Converts Braves â†’ Preachers | Wood + flat terrain |
| **Spy Training Hut** | Converts Braves â†’ Spies | Wood + flat terrain |
| **Boat House** | Produces boats for water travel | Wood + coastal flat terrain |
| **Balloon Hut** | Produces hot air balloons for air travel | Wood + flat terrain |
| **Circle of Reincarnation** | Respawn point for the Shaman | Flat terrain (no wood cost) |
| **Prison** | Holds captured/converted enemies | Wood + flat terrain |

### 4. Spells (26 Total)

#### Terrain Manipulation Spells
| Spell | Effect | Category |
|---|---|---|
| **Raise** | Raises terrain at target | Terrain |
| **Lower** | Lowers terrain at target | Terrain |
| **Hill** | Creates a hill | Terrain |
| **Valley** | Creates a valley | Terrain |
| **Flatten** | Flattens terrain to a uniform level | Terrain |
| **Landbridge** | Raises sea floor to create a land bridge | Terrain |
| **Erode** | Erodes terrain, lowering it gradually | Terrain |

#### Offensive Spells
| Spell | Effect | Category |
|---|---|---|
| **Blast** | Pushes units/buildings back with force | Offensive |
| **Lightning** | Strikes target with lightning bolt | Offensive |
| **Tornado** | Creates a cyclone that destroys buildings and flings units | Offensive |
| **Swamp** | Creates a deadly swamp at target location | Offensive |
| **Firestorm** | Rains fire over an area | Offensive |
| **Earthquake** | Shakes terrain, damaging buildings in area | Offensive |
| **Volcano** | Creates a volcanic eruption, forming new land mass | Offensive |
| **Angel of Death** | Summons a flying angel that hunts and kills enemies | Offensive |

#### Support / Utility Spells
| Spell | Effect | Category |
|---|---|---|
| **Convert** | Converts enemy units or wildmen to your tribe | Support |
| **Ghost Army** | Creates ghostly duplicates of your army to confuse enemies | Support |
| **Invisibility** | Makes selected followers invisible | Support |
| **Magical Shield** | Shields followers from damage and spells | Support |
| **Hypnotise** | Temporarily takes control of an enemy follower | Support |
| **Bloodlust** | Enrages followers, boosting combat stats | Support |
| **Teleport** | Teleports the Shaman to a target location | Support |
| **Swarm** | Sends insects to confuse and scatter enemies | Support |

#### Guest / Special Spells
| Spell | Effect | Category |
|---|---|---|
| **Burn** | Sets target area on fire | Guest |
| **Forge World** | Reshapes the entire world terrain | Guest |
| **Trees** | Grows trees at target location | Guest |
| **Wildmen** | Spawns wildmen at target location | Guest |
| **Armageddon** | Teleports all remaining units to a final battleground | Special |

### 5. Mana System

- **Source**: Housed Braves generate mana passively. More Braves in huts = faster mana income.
- **Sink**: Every spell costs mana to charge and cast. Rechargeable spells regenerate at a rate proportional to total housed population.
- **One-Shot Spells**: Obtained from Stone Heads, Obelisks, Gargoyles â€” used once and gone.
- **Permanent Spells**: Learned at Vaults of Knowledge â€” rechargeable with mana.

### 6. AI Behavior (Original)

- **Autonomous Braves**: Automatically seek trees, harvest wood, build huts on flat terrain, and enter huts to increase population.
- **Defensive AI**: Tribes place Guard Towers at strategic chokepoints with Firewarriors/Preachers.
- **Offensive AI**: Enemy Shamans cast spells, lead armies, and coordinate multi-unit attacks.
- **Tribes**: Up to 4 tribes per map (Blue/player, Red/Dakini, Yellow/Chumara, Green/Matak), each with their own Shaman and full settlement behavior.

---

## Our Extended Systems (Beyond the Original)

### 7. Biome & Climate System

Each tile has **temperature**, **moisture**, and **altitude** values that combine to produce a biome:

| Biome | Temperature | Moisture | Altitude |
|---|---|---|---|
| **Tropical Forest** | Hot | Wet | Low |
| **Desert** | Hot | Dry | Low-Mid |
| **Savanna** | Hot | Medium | Low |
| **Temperate Forest** | Medium | Medium-Wet | Low-Mid |
| **Grassland** | Medium | Medium | Low |
| **Tundra** | Cold | Dry | Mid-High |
| **Taiga** | Cold | Medium | Mid |
| **Snow/Ice** | Cold | Any | High |
| **Swamp/Wetland** | Any | Very Wet | Very Low |
| **Mountain** | Any | Any | Very High |

### 8. Weather System

- **Wind**: Direction and speed affect cloud movement, fire spread, balloon travel.
- **Rain**: Increases moisture, causes flooding in low areas, extinguishes fires, grows vegetation.
- **Storms**: Lightning strikes, tornado spawns, heavy rain â€” can damage structures.
- **Snow**: In cold biomes, slows movement, increases building decay.
- **Fog**: Reduces visibility range for all units.
- **Heat Waves**: In hot/dry biomes, increases fire risk, reduces follower stamina.

### 9. Day/Night & Time System

- **Game Clock**: Configurable time scale (e.g., 1 real second = 1 game minute).
- **Day/Night Cycle**: Affects visibility, unit behavior (sleep at night), predator activity.
- **Seasons**: Spring â†’ Summer â†’ Autumn â†’ Winter. Affects temperature, moisture, vegetation growth, animal behavior.
- **Event Timeline**: Scheduled events (migrations, storms, volcanic activity) triggered by the time system.

### 10. Fauna System (Autonomous Wildlife)

| Category | Examples | Behavior |
|---|---|---|
| **Herbivores** | Deer, Rabbits, Bison | Graze on grasslands, flee from predators, herd behavior |
| **Predators** | Wolves, Bears, Big Cats | Hunt herbivores, territorial, den-based, nocturnal options |
| **Birds** | Eagles, Songbirds | Fly between biomes, nest in trees, migratory |
| **Fish** | River Fish, Ocean Fish | Swim in water bodies, food source for bears/humans |
| **Insects** | Bees, Locusts | Pollinate flora, swarm behavior, crop damage |

**Behaviors**: Hunger-driven foraging, reproduction cycles, territorial marking, predator-prey dynamics (Lotka-Volterra inspired), migration between biomes, sleep/wake cycles.

### 11. Flora System (Autonomous Vegetation)

| Category | Examples | Behavior |
|---|---|---|
| **Trees** | Oak, Pine, Tropical Palm, Dead Trees | Grow over time, produce wood, spread seeds, die from fire/drought |
| **Bushes/Shrubs** | Berry Bushes, Thorns | Provide food for herbivores, slower growth |
| **Grass/Ground Cover** | Grassland, Moss, Snow Cover | Spreads based on moisture, dies in drought |
| **Crops** | Wheat, Vegetables (if settlements farm) | Planted by Braves, require water, seasonal |
| **Aquatic** | Reeds, Kelp, Lily Pads | Grow in water/wetlands, fish habitat |

**Behaviors**: Seed dispersal (wind, water, animal-carried), growth stages (seed â†’ sapling â†’ mature â†’ old â†’ dead), response to fire, drought, flooding, seasonal dormancy, biome-appropriate species distribution.

---

## Architecture: Own Lightweight ECS

### Why ECS?

1. **Massive Entity Count**: Thousands of followers, animals, trees, tiles â€” ECS handles this with cache-friendly data iteration.
2. **Composable Behaviors**: A deer is `[com_position, com_health, com_hunger, com_species, com_prey, com_herd]`. A wolf swaps `com_prey` â†’ `com_predator`. No deep inheritance trees.
3. **Drag-and-Drop Systems**: Want a "Disease System"? Create `com_disease.gd` and `sys_disease.gd` â€” it automatically affects any entity with `com_health + com_disease`. Zero changes to existing code.
4. **Separation of Data and Logic**: Components are pure data. Systems are pure logic. Easy to test, easy to reason about.
5. **Hot-Swappable**: Disable a system at runtime (e.g., turn off weather) without touching any entities.

### Custom ECS Core (No External Dependencies)

We roll our own lightweight ECS inspired by the Godot-ECS-Starter pattern. Four files, ~80 lines total:

| File | Role |
|---|---|
| `ecs/entity.gd` | Entity = just an int ID |
| `ecs/component.gd` | Base class: `extends Resource`, `get_type() -> String` |
| `ecs/system.gd` | Base class: `update(world, delta)` |
| `ecs/world.gd` | Entity store, component store, `query()`, system runner |

Systems execute in registration order via `World._process()`. No runners, no schedulers, no parallel mode. KISS.

### Adding a New System

```
1. Create components/com_disease.gd  (pure data: infection_rate, timer)
2. Create systems/sys_disease.gd     (pure logic: query ["ComHealth", "ComDisease"], apply damage)
3. Register in main.gd:              world.add_system(SysDisease.new())

Done. No other files change.
```

---

## Project Structure

Flat folders with clear prefixes. Every file's purpose is obvious from its path alone. No nested subfolders inside `components/` or `systems/`.

```
populus/
â”‚
â”œâ”€â”€ project.godot
â”œâ”€â”€ README.md                          # â† this file
â”œâ”€â”€ DOCS.md                            # Technical documentation
â”œâ”€â”€ DOCS_SYSTEMS.md                    # Detailed system implementation specs
â”œâ”€â”€ PLAN.md                            # 14-phase implementation roadmap
â”‚
â”œâ”€â”€ ecs/                               # â”€â”€â”€ ECS CORE (4 files, never changes) â”€â”€â”€
â”‚   â”œâ”€â”€ entity.gd                      # Entity = just an int ID
â”‚   â”œâ”€â”€ component.gd                   # Base class: extends Resource, get_type()
â”‚   â”œâ”€â”€ system.gd                      # Base class: update(world, delta)
â”‚   â””â”€â”€ world.gd                       # Entity store, component store, query(), system runner
â”‚
â”œâ”€â”€ components/                        # â”€â”€â”€ ALL COMPONENTS (pure data, flat, com_ prefix) â”€â”€â”€
â”‚   â”œâ”€â”€ com_position.gd                # grid_x, grid_y, world_pos
â”‚   â”œâ”€â”€ com_velocity.gd                # direction, speed
â”‚   â”œâ”€â”€ com_health.gd                  # max_hp, current_hp, regen
â”‚   â”œâ”€â”€ com_tile.gd                    # grid coords, is_flat, is_water, occupant
â”‚   â”œâ”€â”€ com_biome.gd                   # biome_type, temperature, moisture, fertility
â”‚   â”œâ”€â”€ com_tribe.gd                   # tribe_id, tribe_color
â”‚   â”œâ”€â”€ com_ai_state.gd                # current_state, previous_state, timer
â”‚   â”œâ”€â”€ com_building.gd                # building_type, tribe_id, size
â”‚   â”œâ”€â”€ com_mana.gd                    # current, max, regen_rate (per tribe)
â”‚   â”œâ”€â”€ com_species.gd                 # name, diet, preferred_biomes (fauna)
â”‚   â”œâ”€â”€ com_growth.gd                  # stage, rate, age, max_age (flora)
â”‚   â”œâ”€â”€ com_flammable.gd               # flammability, is_burning, burn_timer
â”‚   â””â”€â”€ ...                            # 40+ more (see PLAN.md for full list)
â”‚
â”œâ”€â”€ systems/                           # â”€â”€â”€ ALL SYSTEMS (pure logic, flat, sys_ prefix) â”€â”€â”€
â”‚   â”œâ”€â”€ sys_terrain_generation.gd      # one-shot: noise â†’ heightmap
â”‚   â”œâ”€â”€ sys_terrain_render.gd          # heightmap â†’ mesh update
â”‚   â”œâ”€â”€ sys_biome_assignment.gd        # temp + moisture + altitude â†’ biome
â”‚   â”œâ”€â”€ sys_time.gd                    # advance game clock, day/night, seasons
â”‚   â”œâ”€â”€ sys_weather.gd                 # state machine: clear/cloudy/rain/storm
â”‚   â”œâ”€â”€ sys_flora_growth.gd            # age, stage advance, death
â”‚   â”œâ”€â”€ sys_fauna_ai.gd                # master state machine per animal
â”‚   â”œâ”€â”€ sys_brave_ai.gd                # auto-harvest, auto-build, auto-house
â”‚   â”œâ”€â”€ sys_tribal_ai.gd               # strategic: expand/build army/attack/defend
â”‚   â”œâ”€â”€ sys_mana.gd                    # housed followers â†’ mana pool â†’ charges
â”‚   â”œâ”€â”€ sys_combat.gd                  # melee/ranged attack resolution
â”‚   â”œâ”€â”€ sys_camera_input.gd            # debug/player camera control
â”‚   â””â”€â”€ ...                            # 30+ more (see PLAN.md for full list)
â”‚
â”œâ”€â”€ data/                              # â”€â”€â”€ STATIC DEFINITIONS (readonly config, def_ prefix) â”€â”€â”€
â”‚   â”œâ”€â”€ def_biomes.gd                  # BiomeType enum + per-biome data dict
â”‚   â”œâ”€â”€ def_units.gd                   # RoleType enum + per-role stats dict
â”‚   â”œâ”€â”€ def_buildings.gd               # BuildingType enum + per-building stats dict
â”‚   â”œâ”€â”€ def_spells.gd                  # SpellType enum + per-spell stats dict
â”‚   â”œâ”€â”€ def_fauna.gd                   # species name â†’ stats dict
â”‚   â”œâ”€â”€ def_flora.gd                   # species name â†’ stats dict
â”‚   â””â”€â”€ def_enums.gd                   # shared enums (AIState, TaskType, Season, etc.)
â”‚
â”œâ”€â”€ planet/                            # â”€â”€â”€ PLANET GEOMETRY (pure math/rendering) â”€â”€â”€
â”‚   â”œâ”€â”€ torus_grid.gd                  # 2D wrapping grid data structure
â”‚   â”œâ”€â”€ sphere_projector.gd            # grid coords â†” 3D sphere position
â”‚   â”œâ”€â”€ planet_mesh.gd                 # ArrayMesh generation from heightmap
â”‚   â””â”€â”€ planet_camera.gd               # orbital camera (debug + player)
â”‚
â”œâ”€â”€ generation/                        # â”€â”€â”€ PROCEDURAL GENERATION (one-shot, gen_ prefix) â”€â”€â”€
â”‚   â”œâ”€â”€ gen_heightmap.gd               # noise â†’ heightmap
â”‚   â”œâ”€â”€ gen_biome.gd                   # temp + moisture â†’ biome map
â”‚   â”œâ”€â”€ gen_flora.gd                   # place initial trees/bushes
â”‚   â”œâ”€â”€ gen_fauna.gd                   # place initial animals
â”‚   â””â”€â”€ gen_settlement.gd              # place initial tribes
â”‚
â”œâ”€â”€ shaders/                           # â”€â”€â”€ GPU SHADERS â”€â”€â”€
â”‚   â”œâ”€â”€ terrain.gdshader               # height-based coloring, biome blending
â”‚   â”œâ”€â”€ water.gdshader                 # animated water plane
â”‚   â””â”€â”€ sky.gdshader                   # simple sky gradient
â”‚
â”œâ”€â”€ scenes/                            # â”€â”€â”€ GODOT SCENES â”€â”€â”€
â”‚   â””â”€â”€ main.tscn                      # root scene
â”‚
â”œâ”€â”€ config/                            # â”€â”€â”€ RUNTIME CONFIGURATION â”€â”€â”€
â”‚   â””â”€â”€ game_config.gd                 # autoload: grid size, time scale, all tuning knobs
â”‚
â””â”€â”€ debug/                             # â”€â”€â”€ DEBUG TOOLS â”€â”€â”€
    â”œâ”€â”€ debug_overlay.gd               # F3 toggle: FPS, entity count, tile info
    â””â”€â”€ debug_commands.gd              # console commands: spawn, kill, set weather, etc.
```

### Naming Conventions

| Kind | Prefix | Example | Why |
|---|---|---|---|
| **Component** | `com_` | `com_health.gd` | Instantly know it's pure data |
| **System** | `sys_` | `sys_combat.gd` | Instantly know it's pure logic |
| **Definition** | `def_` | `def_spells.gd` | Instantly know it's static config |
| **Generator** | `gen_` | `gen_heightmap.gd` | Instantly know it's one-shot generation |
| **ECS Core** | none | `world.gd` | Framework layer, never touched |

---

## Quick Start

```bash
# 1. Clone the repository
git clone <repo-url>

# 2. Open in Godot 4.6
# Open project.godot with Godot 4.6 editor

# 3. Run
# Press F5 or click Play
```

---

## Technology Stack

| Technology | Purpose |
|---|---|
| **Godot 4.6** | Game engine |
| **GDScript** | Primary scripting language |
| **Custom ECS** | Own lightweight ECS (~80 lines, no external dependencies) |
| **FastNoiseLite** | Procedural noise for terrain/biome generation (built into Godot) |
| **Godot Shaders** | Terrain rendering, water, atmosphere |

---

## Key Design Decisions

### 1. World-First Development
The entire world simulation (terrain, biomes, flora, fauna, weather, autonomous tribes) must be fully functional before any player interaction is implemented. The player is the last system added.

### 2. Torus-to-Sphere Projection (Not True Sphere)
Matches the original game exactly. All game logic operates on a flat wrapping grid (128Ã—128). Only the rendering projects to a sphere. This massively simplifies pathfinding, terrain manipulation, and spatial queries.

### 3. Own Lightweight ECS (No External Dependencies)
Four files, ~80 lines. Entity = int ID, Component = Resource with data, System = `update(world, delta)`, World = store + query + runner. Systems execute in registration order. No runners, no schedulers, no parallel mode. KISS.

### 4. Flat Folders with Prefixes
No nested subfolders inside `components/` or `systems/`. The `com_` / `sys_` / `def_` / `gen_` prefixes group things naturally. When you have 60 components, you `Ctrl+P` and type `com_health` â€” done.

### 5. Procedural Everything
No sprites, no imported assets. Everything is:
- Procedural meshes (terrain, buildings as colored boxes/shapes)
- Procedural textures (biome colors via shaders)
- Colored geometry placeholders
- Debug visualization (health bars, AI state text)

---

## Implementation Roadmap (14 Phases)

See [PLAN.md](PLAN.md) for the full detailed plan. Summary:

| Part | Phases | What |
|---|---|---|
| **A â€” Foundation** | 0-5 | ECS core, torus grid, sphere mesh, terrain gen, biomes, debug camera |
| **B â€” Nature Lives** | 6-9 | Time/day-night/seasons, weather, flora ecosystem, fauna ecosystem |
| **C â€” Civilization Lives** | 10-12 | Autonomous tribes, buildings/mana/population, spells/combat |
| **D â€” Player Enters** | 13 | Player tribe, input, UI, save/load |

---

## References

- **Populous: The Beginning** (1998) â€” Bullfrog Productions / Electronic Arts
- [Populous Wiki](https://wiki.popre.net/) â€” Community wiki with detailed game mechanics (mana, hut breeding, spells)
- [Red Blob Games â€” Procedural Planet Generation](https://www.redblobgames.com/x/1843-planet-generation/) â€” Spherical terrain generation techniques
- [GameDev StackExchange â€” Populous Geometry](https://gamedev.stackexchange.com/questions/16317/geometry-system-of-populous-the-beginning) â€” Torus-to-sphere analysis
- [ECS Wikipedia](https://en.wikipedia.org/wiki/Entity_component_system) â€” ECS architecture overview

---

## License

TBD

---

## Status

ğŸš§ **Pre-development** â€” Architecture and planning phase. See [PLAN.md](PLAN.md) for the 14-phase roadmap, [DOCS.md](DOCS.md) for technical specifications, and [DOCS_SYSTEMS.md](DOCS_SYSTEMS.md) for detailed system implementation specs.
